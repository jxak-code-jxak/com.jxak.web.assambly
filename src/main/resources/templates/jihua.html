<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" th:href="@{/plugins/layui/css/layui.css}">
    <script th:src="@{/plugins/layui/layui.js}"></script>
</head>
<body>
<div class="layui-tab layui-tab-card">
    <ul class="layui-tab-title">
        <li class="layui-this">安全教育培训计划</li>
        <li>安全教育培训变更记录</li>
    </ul>
    <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
            <table id="pxJH" lay-filter="jhEdit" class="layui-table"></table>
            <script type="text/html" id="jhToolbar" lay-filter="jhToolbar">
                <div class="layui-btn-container">
                    <button TYPE="button" lay-event="add" class="layui-btn layui-btn-sm">新增</button>
                </div>
            </script>
            <script type="text/html" id="jhBar" lay-filter="jhEdit">
                <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">详情</a>
                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
            </script>
        </div>
        <div class="layui-tab-item">
            <table id="pxBG" lay-filter="bgEdit" class="layui-table"></table>
            <script type="text/html" id="bgBar"></script>
        </div>
    </div>
</div>
<script th:inline="none">
    layui.use(['element', 'laydate', 'table','form'], function () {
        var $ = layui.jquery
            , table = layui.table
            , form =layui.form
            , laydate = layui.laydate;
        ; //Tab的切换功能，切换事件监听等，需要依赖element模块

        var xqJH = {
            initJH: function () {
                table.render({
                    elem: '#pxJH'  //绑定table id
                    , url: '/getPlanList'  //数据请求路径
                    , toolbar: '#jhToolbar'
                    , cellMinWidth: 80
                    , cols: [[
                        {checkbox: true, fixed: true},
                        {field: 'planCode', title: '计划编码', sort: true},
                        {field: 'planTime', title: '时间', sort: true},
                        {field: 'planName', title: '计划名称', sort: true},
                        {field: 'trainObject', title: '培训对象', sort: true},
                        {field: 'trainType', title: '培训方式', sort: true},
                        {field: 'state', title: '状态', sort: true},
                        {title: '操作', width: 178, toolbar: '#jhBar', fixed: "right", align: "center"}
                    ]]
                    , page: true   //开启分页
                    , limit: 5   //默认十条数据一页
                    , limits: [10, 20, 30, 50]  //数据分页条
                });
                //监听表格中的工具
                table.on('tool(jhEdit)', function (obj) {
                    var data = obj.data;
                    if (obj.event === 'detail') {
                        layer.msg('ID：' + data.id + ' 的查看操作');
                    } else if (obj.event === 'del') {
                        var deleteData = {id: data.id};
                        xuqiu.deleteXQ(deleteData);
                    } else if (obj.event === 'edit') {
                        var editData = {title: '编辑', btn: '保存', data: data};
                        xuqiu.editXQ(editData);
                    }else if (obj.event==='add'){
                        alert(123)
                    }
                });
                //监听表格头部工具
                table.on('toolbar(jhEdit)',function (obj) {
                    //新增数据
                    if (obj.even()==='add'){

                    }
                })
                //年选择器
                laydate.render({
                    elem: '#yearSelect'
                    ,type: 'year'
                });

                //年月选择器
                laydate.render({
                    elem: '#monthSelect'
                    ,type: 'month'
                });
                //年月日选择器
                laydate.render({
                    elem: '#dateSelect'
                });
            },
            initBG:function () {
                table.render({
                    elem: '#pxBG'  //绑定table id
                    , url: '/getChangeList'  //数据请求路径
                    , toolbar: '#bgBar'
                    , cellMinWidth: 80
                    , cols: [[
                        {checkbox: true, fixed: true},
                        {field: 'planCode', title: '计划编码',templet: '<div>{{d.planEntity.planCode}}</div>', sort: true},
                        {field: 'changeState', title: '变更状态', sort: true},
                        {field: 'planTime', title: '时间',templet: '<div>{{d.planEntity.planTime}}</div>', sort: true},
                        {field: 'planName', title: '计划名称', templet: '<div>{{d.planEntity.planName}}</div>',sort: true},
                        {field: 'planObject', title: '培训对象',templet: '<div>{{d.planEntity.planObject}}</div>', sort: true},
                        {field: 'planType', title: '培训方式',templet: '<div>{{d.planEntity.planType}}</div>', sort: true},
                        {field: 'remark', title: '备注',templet: '<div>{{d.planEntity.planCode}}</div>', sort: true},
                    ]]
                    , page: true   //开启分页
                    , limit: 5   //默认十条数据一页
                    , limits: [10, 20, 30, 50]  //数据分页条
                });
            },
            /**
             * 新增培训计划
             */
            addJH:function () {
                layui.open({

                });
            }
        };
        xqJH.initJH();
        xqJH.initBG();
    });
    function selectType() {
        alert(123)
    }
</script>
</body>
</html>
